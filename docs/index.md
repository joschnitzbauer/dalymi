# dalymi

*[data like you mean it]*  

[![Documentation Status](https://readthedocs.org/projects/dalymi/badge/?version=latest)](http://dalymi.readthedocs.io/en/latest/?badge=latest)

A lightweight, data-focused and non-opinionated pipeline manager written in and for Python.

---

*dalymi* allows to build data processing pipelines as [directed acyclic graphs]([https://en.wikipedia.org/wiki/Directed_acyclic_graph]) (DAGs).  
DAG nodes (or "tasks") are vanilla Python functions with a certain call signature and decorators to specify task dependencies. Task dependencies (DAG edges) are defined implicitly by specifying interim data as inputs and outputs of tasks. Hence, tasks are only executed after input data has been generated by upstream tasks.

*dalymi* aims for rapid prototyping and minimal setup for data-processing projects.  
Several features facilitate this goal:

- simple, non-opinionated API (most choices left to user)
- no external dependencies for pipeline execution
- one-line installation
- no configuration
- auto-generated command line interface for pipeline execution
- DAG visualization using [graphviz](https://www.graphviz.org/)
- API design encourages good development practices (modular code, defined data schemas, code-inherent docs, easy workflow viz, etc.)


## Installation
```
pip install dalymi
```

For the latest development:
```
pip install git+https://github.com/joschnitzbauer/dalymi.git
```

DAG visualization requires [graphviz](https://www.graphviz.org/).

## Tutorial

!!! note
    The full source code for the example in this tutorial can be found at [`dalymi/examples/simple.py`](https://github.com/joschnitzbauer/dalymi/blob/master/examples/simple.py).
    Further examples can be found in the same folder.

*dalymi* programs consist of two main components: resources and tasks. Tasks create resources and use them as input.
Hence, a *dalymi* DAG can be described as a graph of tasks and resources where tasks are dependent on the resources that
they need.

In this tutorial, we will create the following DAG:

![Simple DAG](img/simple.png)

!!! note
    The above image was generated by the *dalymi* graph plot command line interface: `python examples/simple.py dot`

In this graph, ellipses represent tasks and rectangles resources. The first row of rectangles give the name of this
resource. If the resource is a tabular data frame (e.g. a `pandas.DataFrame`) and columns have been specified, then the
remaining rows indicate the expected columns in this resource.

Hence, we can see that the task `create_numbers` produces a resource `numbers` which has a single column called
`number`. `numbers` in return is being used by a task `square_numbers` as an input. Finally, `square_numbers` produces
an output resource `squares` with columns `number` and `square`.

Upon execution of this DAG, *dalymi* attempts to run each task, but will only execute them if the input resources exist.
If an input resource does not exist, *dalymi* will attempt to execute the producing task and revisit the unexecuted task
later.

To define the above task, let's import everything we need first:

``` python
from dalymi import Pipeline
from dalymi.resources import PandasCSV
import pandas as pd
```

We are using a `Pipeline` object to represent the whole pipeline and `PandasCSV` objects to represent Pandas data frame
resources stores as CSV files. We also import `pandas` itself for later use.
